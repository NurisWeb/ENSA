<head>
  <style>
    .calculator {
      background-color: white;
      border-radius: 10px;
      padding: 30px;
      width: 100%;
      max-width: none;
      position: relative;
      letter-spacing: 0.8px;
      font-weight: 700;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .title {
      text-align: center;
      margin-bottom: 20px;
      font-size: 2rem;
    }

    .slider-container {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 20px;
      width: 100%;
    }

    .slider-container label {
      margin-bottom: 5px;
    }

    .slider-container input[type="range"] {
      width: 100%;
    }

    .price-buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin: 32px 0;
    }

    .tooltip > input {
      margin-right: 0.5rem;
    }

    .price-button {
      padding: 10px 20px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      background-color: #f0f0f0;
      transition: all 0.3s ease;
      font-size: 16px;
      color: black;
    }

    .price-button.active {
      background-color: #3041df;
      color: white;
    }

    #total {
      font-size: 24px;
      font-weight: bold;
      text-align: center;
      margin-top: 28px;
      color: black;
    }

    .additional-options .option {
      margin-bottom: 20px;
      width: 100%;
    }

    .additional-options label {
      position: relative;
      display: inline-block;
      font-weight: bold;
      cursor: pointer;
    }

    .tooltiptext {
      visibility: hidden;
      width: 280px;
      background-color: #555;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -140px;
      opacity: 0;
      transition: opacity 0.3s;
      font-weight: normal;
    }

    .tooltiptext::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #555 transparent transparent transparent;
    }

    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }

    .button {
      background-color: #2d6aff;
      border-radius: 50px;
      border: 2px solid white;
      box-shadow: rgb(0 0 0 / 40%) 0px 7px 29px 0px;
      color: white;
      padding: 15px 25px;
      margin: 1rem 1rem;
    }

    .send-request {
      margin-top: 20px;
    }

    .add-carpet-button {
      background-color: #ff9800;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      border: none;
      margin-top: 20px;
    }

    .carpet-item {
      margin-top: 10px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }

    .delete-button {
      background-color: #ff4444;
      color: white;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .price-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    /* Responsive Design */
    @media (width <= 767px) {
      .calculator {
        padding: 20px;
        gap: 8px;
        overflow-y: auto;
        height: 100%
        
      }
      .slider-wrapper {
        display: flex;
        justify-content: space-between;
        width: 100%;
        gap: 40px;

      }

      .price-button {
        font-size: 14px;
        padding: 8px 16px;
        margin: 0px 0px 16px;
        width: 100%;
      }

      .price-buttons {
        margin: 0;
        gap: 0;
      }

      #total {
        font-size: 20px;
      }

      .tooltip {
        font-size: 12px;
      }

      .title {
                font-size: 24px;
        text-align: left;
        font-weight: 800;
        text-transform: uppercase;
        line-height: 1.2;
      }

      .tooltiptext {
        width: 200px;
        left: 50%;
        margin-left: -100px;
      }

      .slider-container label {
         margin-bottom: 25px;
      }

      label {
        font-size: 16px;
      }

      .button {
        background-color: #2d6aff;
        border-radius: 50px;
        border: 2px solid white;
        box-shadow: rgb(0 0 0 / 40%) 0px 7px 29px 0px;
        color: white;
        padding: 8px 25px;
        margin: 0rem 0rem;
        font-size: 1.1rem;
        width: 100%;
      }

      .additional-options .option {
        margin-bottom: 10px;
        width: 100%;
      }

      .add-carpet-button {
           background-color: #00ff9975;
        padding: 4px 12px;
        border-radius: 50px;
        cursor: pointer;
        font-size: 12px;
        border: none;
        margin-top: 16px;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .carpet-item {
    margin-top: 10px;
    padding: 5.2px;
    border: 1px solid #ddd;
    border-radius: 5px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    font-size: 10px;
    gap: 8px;
}

      #total {
        margin-top: 0;
        margin-bottom: 8px;
      }

      #carpetList {
    margin-bottom: 24px;
}

#total {  text-decoration: underline;
  text-underline-offset: 3px;}
      
    }
  
  </style>
</head>

<body>
  <div class="calculator">
    <h2 class="title">Teppichreinigung Kostenrechner</h2>


    <div class="slider-wrapper">
      
      <div class="slider-container">
        <label for="widthRange">Breite: <span id="widthValue">2</span> m</label>
        <input
        type="range"
        id="widthRange"
        min="0"
        max="10"
        step="0.1"
        value="2"
        />
    </div>

    <div class="slider-container">
      <label for="lengthRange">Länge: <span id="lengthValue">2</span> m</label>
      <input
      type="range"
      id="lengthRange"
      min="0"
      max="10"
      step="0.1"
      value="2"
      />
    </div>
    
  </div>
    <div class="price-buttons">
      <button class="price-button active" data-price="9.9">
        Synthetische Teppiche 9,90€ /m²
      </button>
      <button class="price-button" data-price="12.9">
        Langflorteppiche 12,90€ /m²
      </button>
      <button class="price-button" data-price="19.9">
        Traditionelle Teppiche 19,90€ /m²
      </button>
      <button class="price-button" data-price="6.9">
        Teppichboden 6,90€ /m²
      </button>
    </div>

    <div class="additional-options">
      <div class="option">
        <label class="tooltip">
          <input type="checkbox" id="geruchsbehandlungCheckbox" />
          <strong>Hygienebehandlung</strong> m² 5€<span class="tooltiptext">
            Optional buchbar, pro m² 5€. Sehr empfehlenswert bei
            Milbenentfernung und Geruchsbeseitigung wie zum Beispiel Urin oder
            sonstige bakterielle Verunreinigungen.
          </span>
        </label>
      </div>
      <div class="option">
        <label class="tooltip">
          <input type="checkbox" id="impraegnierungCheckbox" />
          <strong>Imprägnierung/Rückfetten</strong> m² 5€<span class="tooltiptext">
            Allgemein schutzabweisende Wirkung. Rückfetten für Wollteppiche,
            sehr empfehlenswert, da Wollteppiche generell Wollfett enthalten.
          </span>
        </label>
      </div>
      <div class="option">
        <button class="add-carpet-button" id="addCarpet">
          <svg
            class="w-6 h-6"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="6"
            height="6"
            fill="yellow"
            viewBox="0 0 24 24"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 7.757v8.486M7.757 12h8.486M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
            />
          </svg>
          Teppich hinzufügen
        </button>
      </div>
    </div>

    <div id="total">Gesamtpreis: 0.00 €</div>

    <ul id="carpetList"></ul>

    <button class="button send-request" id="sendRequest">Anfrage senden</button>

    <div id="contactForm" style="display: none">
      <h3>Kontaktdaten</h3>
      <input type="text" id="contactName" placeholder="Ihr Name" />
      <input type="email" id="contactEmail" placeholder="Ihre E-Mail" />
      <button class="button" id="submitContact">Daten absenden</button>
    </div>
  </div>

  <script>
    let width = 2;
    let length = 2;
    let selectedPrice = 9.9; // Standardmäßig Synthetische Teppiche
    let impraegnierung = false;
    let geruchsbehandlung = false;
    let totalCarpets = [];
    let totalSum = 0;

    const widthRange = document.getElementById("widthRange");
    const lengthRange = document.getElementById("lengthRange");
    const priceButtons = document.querySelectorAll(".price-button");
    const totalDisplay = document.getElementById("total");
    const widthValueDisplay = document.getElementById("widthValue");
    const lengthValueDisplay = document.getElementById("lengthValue");
    const geruchsbehandlungCheckbox = document.getElementById(
      "geruchsbehandlungCheckbox"
    );
    const impraegnierungCheckbox = document.getElementById(
      "impraegnierungCheckbox"
    );
    const addCarpetBtn = document.getElementById("addCarpet");
    const carpetList = document.getElementById("carpetList");
    const sendRequestBtn = document.getElementById("sendRequest");
    const contactForm = document.getElementById("contactForm");
    const submitContactBtn = document.getElementById("submitContact");

    function calculateTotal() {
      const area = width * length;
      let total = area * selectedPrice;

      if (geruchsbehandlung) {
        total += area * 5;
      }

      if (impraegnierung) {
        total += area * 5;
      }

      totalDisplay.textContent = `Gesamtpreis: ${total.toFixed(2)} €`;
      return total;
    }

    function resetFields() {
      width = 2;
      length = 2;
      selectedPrice = 9.9;
      impraegnierung = false;
      geruchsbehandlung = false;

      widthRange.value = width;
      lengthRange.value = length;
      widthValueDisplay.textContent = width.toFixed(1);
      lengthValueDisplay.textContent = length.toFixed(1);
      geruchsbehandlungCheckbox.checked = false;
      impraegnierungCheckbox.checked = false;

      priceButtons.forEach((btn) => btn.classList.remove("active"));
      priceButtons[0].classList.add("active");
      calculateTotal();
    }

    widthRange.addEventListener("input", (e) => {
      width = parseFloat(e.target.value);
      widthValueDisplay.textContent = width.toFixed(1);
      calculateTotal();
    });

    lengthRange.addEventListener("input", (e) => {
      length = parseFloat(e.target.value);
      lengthValueDisplay.textContent = length.toFixed(1);
      calculateTotal();
    });

    priceButtons.forEach((button) => {
      button.addEventListener("click", (e) => {
        selectedPrice = parseFloat(button.getAttribute("data-price"));

        priceButtons.forEach((btn) => btn.classList.remove("active"));
        button.classList.add("active");

        calculateTotal();
      });
    });

    geruchsbehandlungCheckbox.addEventListener("change", (e) => {
      geruchsbehandlung = e.target.checked;
      calculateTotal();
    });

    impraegnierungCheckbox.addEventListener("change", (e) => {
      impraegnierung = e.target.checked;
      calculateTotal();
    });

    addCarpetBtn.addEventListener("click", () => {
      const total = calculateTotal();

      const carpetData = {
        width,
        length,
        selectedPrice,
        impraegnierung,
        geruchsbehandlung,
        total,
      };

      totalCarpets.push(carpetData);
      totalSum += total;

      const listItem = document.createElement("li");
      listItem.classList.add("carpet-item");
      listItem.innerHTML = `Teppich: ${width.toFixed(1)}m x ${length.toFixed(
        1
      )}m, Preis: ${total.toFixed(
        2
      )}€<button class="delete-button">Löschen</button>`;
      carpetList.appendChild(listItem);

      // Löschen-Funktion
      listItem.querySelector(".delete-button").addEventListener("click", () => {
        carpetList.removeChild(listItem);
        totalCarpets = totalCarpets.filter((item) => item !== carpetData);
        totalSum -= total;
      });

      resetFields();
    });

    sendRequestBtn.addEventListener("click", () => {
      contactForm.style.display = "block";
    });

    submitContactBtn.addEventListener("click", () => {
      const name = document.getElementById("contactName").value;
      const email = document.getElementById("contactEmail").value;

      if (name && email) {
        // Hier kann später EmailJS integriert werden
        console.log("Kontaktdaten:", { name, email });
        console.log("Teppichdaten:", totalCarpets);
      }
    });

    // Initial setup
    calculateTotal();
  </script>
</body>
